scale_fill_brewer(palette="Blues") +
labs(x = "Mice Age",
y = "Number of Branchpoints")
df <- data.frame(miceage=c("p2","p3","p4","p5","p6","p7"),
f1 = f1, f2 = f2, f3 = f3, f4 = f4, f5 = f5)
ggplot(data=df, aes(x=miceage, y=f1, fill = miceage)) +
geom_bar(stat="identity", width=0.8) +
scale_fill_brewer(palette="Blues") +
labs(x = "Mice Age", y = "Number of Branchpoints")
ggplot(data=df, aes(x=miceage, y=f1, fill = miceage)) +
geom_bar(stat="identity", width=0.8) +
scale_fill_brewer(palette="Blues") +
labs(x = "Mice Age", y = "Number of Branchpoints")
ggplot(data=df, aes(x=miceage, y=f2, fill = miceage)) +
geom_bar(stat="identity", width=0.8) +
scale_fill_brewer(palette="Blues", "Mice age") +
labs(x = "Mice Age", y = "Number of Vessel Edges")
f6 = c(mean(my_image2), mean(my_image3), mean(my_image4),
mean(my_image5), mean(my_image6), mean(my_image7))
df <- data.frame(miceage=c("p2","p3","p4","p5","p6","p7"),
f1 = f1, f2 = f2, f3 = f3, f4 = f4, f5 = f5, f6 = f6)
head(p2_degree)
##
f7 = c(max(p2_degree$distance), max(p3_degree$distance), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
par(mfrow=c(3,3))
install.packages("gridExtra")
library(gridExtra)
install.packages("cowplot")
library(cowplot)
plot_grid(p1,p2,p3,p4,p5,p6,p7, labels = "AUTO")
ㅇㄹ
## VAD: ratio of the total image area occupied by blood vessel area
f6 = c(mean(my_image2), mean(my_image3), mean(my_image4),
mean(my_image5), mean(my_image6), mean(my_image7))
##
f7 = c(max(p2_degree$distance), max(p3_degree$distance), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
df <- data.frame(miceage=c("p2","p3","p4","p5","p6","p7"),
f1 = f1, f2 = f2, f3 = f3, f4 = f4, f5 = f5, f6 = f6, f7 = f7)
ㅇㄹ
df
f1[2:6]/f1[1:5]
ggplot(data=df, aes(x=miceage, y=c(0,f1[2:6]/f1[1:5]))) +
geom_point() +
geom_line() +
labs(x = "Mice Age", y = "Increase rate")
ggplot(data=df, aes(x=miceage, y=c(0,f1[2:6]/f1[1:5]))) +
geom_line() +
labs(x = "Mice Age", y = "Increase rate")
ggplot(data=df, aes(x=miceage, y=c(0,f1[2:6]/f1[1:5]))) +
geom_point() +
geom_line() +
labs(x = "Mice Age", y = "Increase rate")
ggplot(aes(x=c("p2","p3","p4","p5","p6","p7"), y=c(0,f1[2:6]/f1[1:5]))) +
geom_point() +
geom_line() +
labs(x = "Mice Age", y = "Increase rate")
ggplot(data=df, aes(x=c("p2","p3","p4","p5","p6","p7"), y=c(0,f1[2:6]/f1[1:5]))) +
geom_point() +
geom_line() +
labs(x = "Mice Age", y = "Increase rate")
ggplot(data=df, aes(x=c("p2","p3","p4","p5","p6","p7"), y=c(0,f1[2:6]/f1[1:5]), group = 1)) +
geom_point() +
geom_line() +
labs(x = "Mice Age", y = "Increase rate")
f1[2:6]/f1[1:5]
f1[2:6]/f1[1:5]-1
ggplot(data=df, aes(x=c("p2","p3","p4","p5","p6","p7"), y=c(0,f1[2:6]/f1[1:5]-1), group = 1)) +
geom_point() +
geom_line() +
labs(x = "Mice Age", y = "Increase rate")
ggplot(data=df, aes(x=c("p2","p3","p4","p5","p6","p7"), y=c(0,f7[2:6]/f7[1:5]-1), group = 1)) +
geom_point() +
geom_line() +
labs(x = "Mice Age", y = "Increase rate")
p7 <- ggplot(data=df, aes(x=miceage, y=f7, fill = miceage)) +
geom_bar(stat="identity", width=0.8) +
scale_fill_brewer(palette="Blues", "Mice age") +
labs(x = "Mice Age", y = "Distance from center to end")
p7
p7 <- ggplot(data=df, aes(x=miceage, y=f7, fill = miceage)) +
geom_bar(stat="identity", width=0.8) +
scale_fill_brewer(palette="Blues", "Mice age", show.legend=FALSE) +
labs(x = "Mice Age", y = "Distance from center to end")
p7 <- ggplot(data=df, aes(x=miceage, y=f7, fill = miceage)) +
geom_bar(stat="identity", width=0.8, show.legend=FALSE) +
scale_fill_brewer(palette="Blues", "Mice age") +
labs(x = "Mice Age", y = "Distance from center to end")
p7
p7 <- ggplot(data=df, aes(x=miceage, y=f7, fill = miceage)) +
geom_bar(stat="identity", width=0.8, show.legend=FALSE) +
scale_fill_brewer(palette="Blues") +
labs(x = "Mice Age", y = "Distance from center to end")
p7
library(tidyverse)
library(tidyverse)
library(readxl)
p2_degree = read_excel(path = "feature/p2-fro_degreedata.xlsx", col_names = TRUE)
p3_degree = read_excel(path = "feature/p3-fro_degreedata.xlsx", col_names = TRUE)
p4_degree = read_excel(path = "feature/p4-fro_degreedata.xlsx", col_names = TRUE)
p5_degree = read_excel(path = "feature/p5-fro_degreedata.xlsx", col_names = TRUE)
p6_degree = read_excel(path = "feature/p6-fro_degreedata.xlsx", col_names = TRUE)
p7_degree = read_excel(path = "feature/p7-fro_degreedata.xlsx", col_names = TRUE)
library(tidyverse)
library(readxl)
p2_degree = read_excel(path = "feature/p2-fro_degreedata.xlsx", col_names = TRUE)
p3_degree = read_excel(path = "feature/p3-fro_degreedata.xlsx", col_names = TRUE)
p4_degree = read_excel(path = "feature/p4-fro_degreedata.xlsx", col_names = TRUE)
p5_degree = read_excel(path = "feature/p5-fro_degreedata.xlsx", col_names = TRUE)
p6_degree = read_excel(path = "feature/p6-fro_degreedata.xlsx", col_names = TRUE)
p7_degree = read_excel(path = "feature/p7-fro_degreedata.xlsx", col_names = TRUE)
### Count of branchpoints
```{r}
# Count of branchpoints
nrow(p2_degree)
nrow(p3_degree)
nrow(p4_degree)
nrow(p5_degree)
# Branching number per node
# Spatial density of nodes
deg_spatial_density = data.frame(miceage = c(), degree = c(), density = c())
degree = p2_degree$degree
deg_density = table(degree)[max(degree):1] %>%
prop.table() %>%
cumsum() %>%
rev()
deg_density = table(degree)[max(degree):1] %>%
prop.table() %>%
cumsum() %>%
rev()
deg_spatial_density = rbind(deg_spatial_density,
data.frame(miceage = rep("p3",max(degree)), degree = 1:max(degree), density = deg_density))
degree = p4_degree$degree
deg_spatial_density = rbind(deg_spatial_density,
data.frame(miceage = rep("p4",max(degree)), degree = 1:max(degree), density = deg_density))
deg_density = table(degree)[max(degree):1] %>%
prop.table() %>%
cumsum() %>%
rev()
deg_spatial_density = rbind(deg_spatial_density,
data.frame(miceage = rep("p5",max(degree)), degree = 1:max(degree), density = deg_density))
p2_all = read_excel(path = "feature/p2-fro_alldata.xlsx", col_names = TRUE)
p3_all = read_excel(path = "feature/p3-fro_alldata.xlsx", col_names = TRUE)
p4_all = read_excel(path = "feature/p4-fro_alldata.xlsx", col_names = TRUE)
p5_all = read_excel(path = "feature/p5-fro_alldata.xlsx", col_names = TRUE)
p6_all = read_excel(path = "feature/p6-fro_alldata.xlsx", col_names = TRUE)
p7_all = read_excel(path = "feature/p7-fro_alldata.xlsx", col_names = TRUE)
p2_all = read_excel(path = "feature/p2-fro_alldata.xlsx", col_names = TRUE)
p3_all = read_excel(path = "feature/p3-fro_alldata.xlsx", col_names = TRUE)
p4_all = read_excel(path = "feature/p4-fro_alldata.xlsx", col_names = TRUE)
p5_all = read_excel(path = "feature/p5-fro_alldata.xlsx", col_names = TRUE)
p6_all = read_excel(path = "feature/p6-fro_alldata.xlsx", col_names = TRUE)
p7_all = read_excel(path = "feature/p7-fro_alldata.xlsx", col_names = TRUE)
nrow(p2_all)
nrow(p3_all)
nrow(p4_all)
nrow(p5_all)
##
f7 = c(max(p2_degree$distance), max(p3_degree$distance), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
ㄹf7
f7
quantile
quantile(p2_degree$distance, 0.95)
quantile(p2_degree$distance, 0.99)
f7 = c(quantile(p2_degree$distance, 0.90), quantile(p3_degree$distance, 0.90), quantile(p4_degree$distance, 0.90),
quantile(p5_degree$distance, 0.90), quantile(p6_degree$distance, 0.90), quantile(p7_degree$distance, 0.90))
f7
f7 = c(quantile(p2_degree$distance, 0.80), quantile(p3_degree$distance, 0.80), quantile(p4_degree$distance, 0.80),
quantile(p5_degree$distance, 0.80), quantile(p6_degree$distance, 0.80), quantile(p7_degree$distance, 0.80))
f7
f7 = c(quantile(p2_degree$distance, 0.60), quantile(p3_degree$distance, 0.60), quantile(p4_degree$distance, 0.60),
quantile(p5_degree$distance, 0.60), quantile(p6_degree$distance, 0.60), quantile(p7_degree$distance, 0.60))
f7
length(p2_degree$distance)
length(p5_degree$distance)
f7 = c(quantile(p2_degree$distance, 0.95), quantile(p3_degree$distance, 0.95), quantile(p4_degree$distance, 0.95),
quantile(p5_degree$distance, 0.95), quantile(p6_degree$distance, 0.95), quantile(p7_degree$distance, 0.95))
f7
f7 = c(quantile(p2_degree$distance, 0.95), quantile(p3_degree$distance, 0.95), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
f7
f7 = c(quantile(p2_degree$distance, 0.90), quantile(p3_degree$distance, 0.90), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
f7
length(p2_degree$distance)
p2_degree$distance
sort(p2_degree$distance)
p2_degree = read_excel(path = "feature/p2-fro_degreedata.xlsx", col_names = TRUE)
p3_degree = read_excel(path = "feature/p3-fro_degreedata.xlsx", col_names = TRUE)
p4_degree = read_excel(path = "feature/p4-fro_degreedata.xlsx", col_names = TRUE)
p5_degree = read_excel(path = "feature/p5-fro_degreedata.xlsx", col_names = TRUE)
p6_degree = read_excel(path = "feature/p6-fro_degreedata.xlsx", col_names = TRUE)
p7_degree = read_excel(path = "feature/p7-fro_degreedata.xlsx", col_names = TRUE)
library(gridExtra)
library(cowplot)
## VAD: ratio of the total image area occupied by blood vessel area
f6 = c(mean(my_image2), mean(my_image3), mean(my_image4),
mean(my_image5), mean(my_image6), mean(my_image7))
##
f7 = c(max(p2_degree$distance), max(p3_degree$distance), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
f7 = c(quantile(p2_degree$distance, 0.90), quantile(p3_degree$distance, 0.90), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
quantile(p4_degree$distance, 0.95),
##
f7 = c(max(p2_degree$distance), max(p3_degree$distance), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
f7
f7 = c(quantile(p2_degree$distance, 0.90), quantile(p3_degree$distance, 0.90), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
f7
f7 = c(quantile(p2_degree$distance, 0.95), quantile(p3_degree$distance, 0.95), quantile(p4_degree$distance, 0.95),
quantile(p5_degree$distance, 0.95), quantile(p6_degree$distance, 0.95), quantile(p7_degree$distance, 0.95))
f7
f7 = c(quantile(p2_degree$distance, 0.90), quantile(p3_degree$distance, 0.90), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
df <- data.frame(stage=c("P2","P3","P4","P5","P6","P7"),
f1 = f1, f2 = f2, f3 = f3, f4 = f4, f5 = f5, f6 = f6, f7 = f7)
colnames(df) <- c("stage", "Number.of.Branchpoints", "Number.of.Vessel.Edges", "Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity", "Mean.of.Vessel.Width", "VAD", "Distance.from.center.to.end")
df_long <- gather(df, key = "feature", value = "value",
Number.of.Branchpoints, Number.of.Vessel.Edges, Mean.of.Vessel.Length,
Mean.of.Vessel.Tortuosity, Mean.of.Vessel.Width, VAD, Distance.from.center.to.end)
df_long$feature <- factor(df_long$feature, levels = c("Number.of.Branchpoints",
"Number.of.Vessel.Edges",
"Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity",
"Mean.of.Vessel.Width",
"VAD",
"Distance.from.center.to.end"))
df <- data.frame(stage=c("P2","P3","P4","P5","P6","P7"),
f1 = f1, f2 = f2, f3 = f3, f4 = f4, f5 = f5, f6 = f6, f7 = f7)
colnames(df) <- c("stage", "Number.of.Branchpoints", "Number.of.Vessel.Edges", "Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity", "Mean.of.Vessel.Width", "VAD", "Distance.from.center.to.end")
df_long <- gather(df, key = "feature", value = "value",
Number.of.Branchpoints, Number.of.Vessel.Edges, Mean.of.Vessel.Length,
Mean.of.Vessel.Tortuosity, Mean.of.Vessel.Width, VAD, Distance.from.center.to.end)
df_long$feature <- factor(df_long$feature, levels = c("Number.of.Branchpoints",
"Number.of.Vessel.Edges",
"Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity",
"Mean.of.Vessel.Width",
"VAD",
"Distance.from.center.to.end"))
feature.p <- ggplot(data=df_long, aes(x=stage, y=value, fill = stage)) +
geom_bar(stat="identity", width=0.8, show.legend=FALSE)  + facet_wrap(.~feature, nrow = 1, scales = "free")+theme(axis.title.x = element_blank(), strip.text = element_text(size=7.5), panel.spacing.y = unit(1, "lines")) + scale_fill_manual(name="Mice age", values = c("red","orange","magenta","green","blue","black"))
library(egg)
library(gridExtra)
feature.p1 <- feature.p  %+% df_long[1:24,] + labs(x = NULL)
feature.p2 <- feature.p  %+% df_long[-(1:24),]
grid.arrange(grobs = lapply(
list(feature.p1, feature.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
feature.p <- ggplot(data=df_long, aes(x=stage, y=value, fill = stage)) +
geom_bar(stat="identity", width=0.8, show.legend=FALSE)  + facet_wrap(.~feature, nrow = 1, scales = "free")+theme(strip.text = element_text(size=7.5)) + scale_fill_manual(values = c("#FC4E07", "#E69F00", "#F0E442", "#009E73", "#56B4E9","#CC79A7"))
library(egg)
library(egg)
library(gridExtra)
rate.p1 <- rate.p  %+% df.rate_long[1:24,] + labs(x = NULL)
rate.p2 <- rate.p  %+% df.rate_long[-(1:24),]
##
f7 = c(max(p2_degree$distance), max(p3_degree$distance), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
df <- data.frame(stage=c("p2","p3","p4","p5","p6","p7"),
f1 = f1, f2 = f2, f3 = f3, f4 = f4, f5 = f5, f6 = f6, f7 = f7)
colnames(df) <- c("stage", "Number.of.Branchpoints", "Number.of.Vessel.Edges", "Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity", "Mean.of.Vessel.Width", "VAD", "Distance.from.center.to.end")
df_long <- gather(df, key = "feature", value = "value",
Number.of.Branchpoints, Number.of.Vessel.Edges, Mean.of.Vessel.Length,
Mean.of.Vessel.Tortuosity, Mean.of.Vessel.Width, VAD, Distance.from.center.to.end)
df_long$feature <- factor(df_long$feature, levels = c("Number.of.Branchpoints",
"Number.of.Vessel.Edges",
"Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity",
"Mean.of.Vessel.Width",
"VAD",
"Distance.from.center.to.end"))
feature.p <- ggplot(data=df_long, aes(x=stage, y=value, fill = stage)) +
geom_bar(stat="identity", width=0.8, show.legend=FALSE)  + facet_wrap(.~feature, nrow = 1, scales = "free")+theme(strip.text = element_text(size=7.5)) + scale_fill_manual(values = c("#FC4E07", "#E69F00", "#F0E442", "#009E73", "#56B4E9","#CC79A7"))
library(egg)
library(gridExtra)
feature.p1 <- feature.p  %+% df_long[1:24,] + labs(x = NULL)
feature.p2 <- feature.p  %+% df_long[-(1:24),]
grid.arrange(grobs = lapply(
list(feature.p1, feature.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
df.rate <- data.frame(stage=c("p2","p3","p4","p5","p6","p7"),
f1 = c(0,f1[2:6]/f1[1:5]-1), f2 = c(0,f2[2:6]/f2[1:5]-1),
f3 = c(0,f3[2:6]/f3[1:5]-1), f4 = c(0,f4[2:6]/f4[1:5]-1),
f5 = c(0,f5[2:6]/f5[1:5]-1), f6 = c(0,f6[2:6]/f6[1:5]-1),
f7 = c(0,f7[2:6]/f7[1:5]-1))
colnames(df.rate) <- c("stage", "Number.of.Branchpoints", "Number.of.Vessel.Edges", "Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity", "Mean.of.Vessel.Width", "VAD", "Distance.from.center.to.end")
df.rate_long <- gather(df.rate, key = "feature", value = "Increase.rate",
Number.of.Branchpoints, Number.of.Vessel.Edges, Mean.of.Vessel.Length,
Mean.of.Vessel.Tortuosity, Mean.of.Vessel.Width, VAD, Distance.from.center.to.end)
df.rate_long$feature <- factor(df.rate_long$feature, levels = c("Number.of.Branchpoints",
"Number.of.Vessel.Edges",
"Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity",
"Mean.of.Vessel.Width",
"VAD",
"Distance.from.center.to.end"))
rate.p <- ggplot(data=df.rate_long, aes(x=stage, y=Increase.rate, group = 1)) +
geom_point(aes(colour = factor(stage))) + geom_line() + facet_wrap(.~feature, nrow = 1) + theme(strip.text = element_text(size=7.5)) + scale_fill_manual(values = c("#FC4E07", "#E69F00", "#F0E442", "#009E73", "#56B4E9","#CC79A7"))+ scale_y_continuous(limits = c(-0.5, 1.5)) + theme(legend.position = "none")
library(egg)
library(gridExtra)
rate.p1 <- rate.p  %+% df.rate_long[1:24,] + labs(x = NULL)
rate.p2 <- rate.p  %+% df.rate_long[-(1:24),]
grid.arrange(grobs = lapply(
list(rate.p1, rate.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
f7 = c(quantile(p2_degree$distance, 0.90), quantile(p3_degree$distance, 0.90), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
df <- data.frame(stage=c("P2","P3","P4","P5","P6","P7"),
f1 = f1, f2 = f2, f3 = f3, f4 = f4, f5 = f5, f6 = f6, f7 = f7)
colnames(df) <- c("stage", "Number.of.Branchpoints", "Number.of.Vessel.Edges", "Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity", "Mean.of.Vessel.Width", "VAD", "Distance.from.center.to.end")
df_long <- gather(df, key = "feature", value = "value",
Number.of.Branchpoints, Number.of.Vessel.Edges, Mean.of.Vessel.Length,
Mean.of.Vessel.Tortuosity, Mean.of.Vessel.Width, VAD, Distance.from.center.to.end)
feature.p <- ggplot(data=df_long, aes(x=stage, y=value, fill = stage)) +
geom_bar(stat="identity", width=0.8, show.legend=FALSE)  + facet_wrap(.~feature, nrow = 1, scales = "free")+theme(axis.title.x = element_blank(), strip.text = element_text(size=7.5), panel.spacing.y = unit(1, "lines")) + scale_fill_manual(name="Mice age", values = c("red","orange","magenta","green","blue","black"))
library(egg)
library(gridExtra)
feature.p1 <- feature.p  %+% df_long[1:24,] + labs(x = NULL)
feature.p2 <- feature.p  %+% df_long[-(1:24),]
grid.arrange(grobs = lapply(
list(feature.p1, feature.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
grid.arrange(grobs = lapply(
list(feature.p1, feature.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
df.rate <- data.frame(stage=c("P2","P3","P4","P5","P6","P7"),
f1 = c(0,f1[2:6]/f1[1:5]-1), f2 = c(0,f2[2:6]/f2[1:5]-1),
f3 = c(0,f3[2:6]/f3[1:5]-1), f4 = c(0,f4[2:6]/f4[1:5]-1),
f5 = c(0,f5[2:6]/f5[1:5]-1), f6 = c(0,f6[2:6]/f6[1:5]-1),
f7 = c(0,f7[2:6]/f7[1:5]-1))
df.rate <- data.frame(stage=c("P2","P3","P4","P5","P6","P7"),
f1 = c(0,f1[2:6]/f1[1:5]-1), f2 = c(0,f2[2:6]/f2[1:5]-1),
f3 = c(0,f3[2:6]/f3[1:5]-1), f4 = c(0,f4[2:6]/f4[1:5]-1),
f5 = c(0,f5[2:6]/f5[1:5]-1), f6 = c(0,f6[2:6]/f6[1:5]-1),
f7 = c(0,f7[2:6]/f7[1:5]-1))
colnames(df.rate) <- c("stage", "Number.of.Branchpoints", "Number.of.Vessel.Edges", "Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity", "Mean.of.Vessel.Width", "VAD", "Distance.from.center.to.end")
df.rate_long <- gather(df.rate, key = "feature", value = "Increase.rate",
Number.of.Branchpoints, Number.of.Vessel.Edges, Mean.of.Vessel.Length,
Mean.of.Vessel.Tortuosity, Mean.of.Vessel.Width, VAD, Distance.from.center.to.end)
df.rate_long$feature <- factor(df.rate_long$feature, levels = c("Number.of.Branchpoints",
"Number.of.Vessel.Edges",
"Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity",
"Mean.of.Vessel.Width",
"VAD",
"Distance.from.center.to.end"))
library(egg)
library(gridExtra)
rate.p1 <- rate.p  %+% df.rate_long[1:24,] + labs(x = NULL)
rate.p2 <- rate.p  %+% df.rate_long[-(1:24),]
grid.arrange(grobs = lapply(
list(rate.p1, rate.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
grid.arrange(grobs = lapply(
list(feature.p1, feature.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
rate.p <- ggplot(data=df.rate_long, aes(x=stage, y=Increase.rate, group = 1)) +
geom_point(aes(colour = factor(stage))) + geom_line() + facet_wrap(.~feature, nrow = 1) + theme(axis.title.x = element_blank(), strip.text = element_text(size=7.5)) + scale_color_manual(name="Mice age", values = c("red","orange","magenta","green","blue","black"))+ scale_y_continuous(limits = c(-0.5, 1.5)) + theme(legend.position = "none",panel.spacing.y = unit(1, "lines"))
library(egg)
library(gridExtra)
feature.p1 <- feature.p  %+% df_long[1:24,] + labs(x = NULL)
feature.p2 <- feature.p  %+% df_long[-(1:24),]
grid.arrange(grobs = lapply(
list(feature.p1, feature.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
rate.p
rate.p1 <- rate.p  %+% df.rate_long[1:24,] + labs(x = NULL)
rate.p2 <- rate.p  %+% df.rate_long[-(1:24),]
grid.arrange(grobs = lapply(
list(rate.p1, rate.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
feature.p <- ggplot(data=df_long, aes(x=stage, y=value, fill = stage)) +
geom_bar(stat="identity", width=0.8, show.legend=FALSE)  + facet_wrap(.~feature, nrow = 1, scales = "free")+theme(axis.title.x = element_blank(), strip.text = element_text(size=7.5), panel.spacing.y = unit(1, "lines")) + scale_fill_manual(name="Mice age", values = c("red","orange","magenta","green","blue","black"))
feature.p
feature.p
feature.p1 <- feature.p  %+% df_long[1:24,] + labs(x = NULL)
feature.p2 <- feature.p  %+% df_long[-(1:24),]
grid.arrange(grobs = lapply(
list(feature.p1, feature.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
grid.arrange(grobs = lapply(
list(rate.p1, rate.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
grid.arrange(grobs = lapply(
list(feature.p1, feature.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
grid.arrange(grobs = lapply(
list(rate.p1, rate.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
## VAD: ratio of the total image area occupied by blood vessel area
f6 = c(mean(my_image2), mean(my_image3), mean(my_image4),
mean(my_image5), mean(my_image6), mean(my_image7))
f7 = c(quantile(p2_degree$distance, 0.90), quantile(p3_degree$distance, 0.90), max(p4_degree$distance),
max(p5_degree$distance), max(p6_degree$distance), max(p7_degree$distance))
df <- data.frame(stage=c("P2","P3","P4","P5","P6","P7"),
f1 = f1, f2 = f2, f3 = f3, f4 = f4, f5 = f5, f6 = f6, f7 = f7)
colnames(df) <- c("stage", "Number.of.Branchpoints", "Number.of.Vessel.Edges", "Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity", "Mean.of.Vessel.Width", "VAD", "Distance.from.center.to.end")
df_long <- gather(df, key = "feature", value = "value",
Number.of.Branchpoints, Number.of.Vessel.Edges, Mean.of.Vessel.Length,
Mean.of.Vessel.Tortuosity, Mean.of.Vessel.Width, VAD, Distance.from.center.to.end)
df_long$feature <- factor(df_long$feature, levels = c("Number.of.Branchpoints",
"Number.of.Vessel.Edges",
"Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity",
"Mean.of.Vessel.Width",
"VAD",
"Distance.from.center.to.end"))
feature.p <- ggplot(data=df_long, aes(x=stage, y=value, fill = stage)) +
geom_bar(stat="identity", width=0.8, show.legend=FALSE)  + facet_wrap(.~feature, nrow = 1, scales = "free")+theme(axis.title.x = element_blank(), strip.text = element_text(size=7.5), panel.spacing.y = unit(1, "lines")) + scale_fill_manual(name="Mice age", values = c("red","orange","magenta","green","blue","black"))
library(egg)
library(gridExtra)
feature.p1 <- feature.p  %+% df_long[1:24,] + labs(x = NULL)
feature.p2 <- feature.p  %+% df_long[-(1:24),]
grid.arrange(grobs = lapply(
list(feature.p1, feature.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
grid.arrange(grobs = lapply(
list(feature.p1, feature.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
df.rate <- data.frame(stage=c("P2","P3","P4","P5","P6","P7"),
f1 = c(0,f1[2:6]/f1[1:5]-1), f2 = c(0,f2[2:6]/f2[1:5]-1),
f3 = c(0,f3[2:6]/f3[1:5]-1), f4 = c(0,f4[2:6]/f4[1:5]-1),
f5 = c(0,f5[2:6]/f5[1:5]-1), f6 = c(0,f6[2:6]/f6[1:5]-1),
f7 = c(0,f7[2:6]/f7[1:5]-1))
df.rate <- data.frame(stage=c("P2","P3","P4","P5","P6","P7"),
f1 = c(0,f1[2:6]/f1[1:5]-1), f2 = c(0,f2[2:6]/f2[1:5]-1),
f3 = c(0,f3[2:6]/f3[1:5]-1), f4 = c(0,f4[2:6]/f4[1:5]-1),
f5 = c(0,f5[2:6]/f5[1:5]-1), f6 = c(0,f6[2:6]/f6[1:5]-1),
f7 = c(0,f7[2:6]/f7[1:5]-1))
colnames(df.rate) <- c("stage", "Number.of.Branchpoints", "Number.of.Vessel.Edges", "Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity", "Mean.of.Vessel.Width", "VAD", "Distance.from.center.to.end")
df.rate_long <- gather(df.rate, key = "feature", value = "Increase.rate",
Number.of.Branchpoints, Number.of.Vessel.Edges, Mean.of.Vessel.Length,
Mean.of.Vessel.Tortuosity, Mean.of.Vessel.Width, VAD, Distance.from.center.to.end)
df.rate_long$feature <- factor(df.rate_long$feature, levels = c("Number.of.Branchpoints",
"Number.of.Vessel.Edges",
"Mean.of.Vessel.Length",
"Mean.of.Vessel.Tortuosity",
"Mean.of.Vessel.Width",
"VAD",
"Distance.from.center.to.end"))
rate.p <- ggplot(data=df.rate_long, aes(x=stage, y=Increase.rate, group = 1)) +
geom_point(aes(colour = factor(stage))) + geom_line() + facet_wrap(.~feature, nrow = 1) + theme(axis.title.x = element_blank(), strip.text = element_text(size=7.5)) + scale_color_manual(name="Mice age", values = c("red","orange","magenta","green","blue","black"))+ scale_y_continuous(limits = c(-0.5, 1.5)) + theme(legend.position = "none",panel.spacing.y = unit(1, "lines"))
library(egg)
library(gridExtra)
rate.p1 <- rate.p  %+% df.rate_long[1:24,] + labs(x = NULL)
rate.p2 <- rate.p  %+% df.rate_long[-(1:24),]
grid.arrange(grobs = lapply(
list(rate.p1, rate.p2),
set_panel_size,
width = unit(3.6, "cm"),
height = unit(4, "cm")
))
feature.p <- ggplot(data=df_long, aes(x=stage, y=value, fill = stage)) +
geom_bar(stat="identity", width=0.8, show.legend=FALSE)  + facet_wrap(.~feature, nrow = 1, scales = "free")+theme(axis.title.x = element_blank(), strip.text = element_text(size=7.5), panel.spacing.y = unit(1, "lines")) + scale_fill_manual(name="Mice age", values = c("red","orange","magenta","green","blue","black"))
